<!doctype html>
<html lang="en">
    <head>
        <title>Goodbye Wordpress, hi rstblog!</title>

        <!-- meta -->
        <meta name="author" content="Danilo Bargen">
        <meta name="dc.language" content="en-US">
        <meta name="dc.license" content="http://creativecommons.org/licenses/by-sa/3.0/">
        <meta name="description" content="I just replaced Wordpress with rstblog.">
        <meta name="keywords" content="blog, python, rst, rstblog">
        
            <meta name="dc.date.created" content="2012-06-11">
            <meta name="dc.date.issued" content="2012-06-11">
        
        <meta name="google-site-verification" content="uJWWR6d5ESb8torD0v97T_07HLMGX7VzQ-smcUTc_IQ" />

        <!-- favicon -->
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <!-- newsfeed -->
        <link href="/feed.atom" rel="alternate" title="Feed" type="application/atom+xml">

        <!-- assets -->
        <link href="https://fonts.googleapis.com/css?family=Linden+Hill:400,400italic" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="/static/style.css?1371592067" type="text/css">
            <link rel="stylesheet" href="/static/_pygments.css?1371592069" type="text/css">
    </head>
    <body>
        <div id="wrapper">
            <div id="blogtitle"><a href="/">blog.dbrgn.ch</a></div>
            <ul id="mainnav">
                <li><a href="/">home</a></li>
                <li><a href="/archive/">archive</a></li>
                <li><a href="/tags/">tags</a></li>
                <li><a href="/blog/">about this blog</a></li>
                <li class="last"><a href="/about/">about me</a></li>
            </ul>

            <div class="clearboth"></div>

            <div id="content" class="hyphenate">
                
  <h1 class="title">Goodbye Wordpress, hi rstblog!</h1>

  
    <div class="date">
      <p>written on Monday, June 11, 2012</p>
    </div>
  

  <p>Since having switched from the PHP world to the Python world about 2 years ago, I thought about
relaunching my Blog using Python instead of PHP. At first, I thought about creating an application
with Django and PostgreSQL, but never really had the time and motivation to finally implement it.
But today I stumbled over <a class="reference external" href="https://github.com/mitsuhiko/rstblog">rstblog</a> by <a class="reference external" href="http://lucumr.pocoo.org/">Armin Ronacher</a>.</p>
<div class="section" id="meet-rstblog">
<h2>Meet rstblog</h2>
<p>It is basically a static <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> to HTML converter. You create a
<cite>year/month/day</cite> folder structure, create <cite>.rst</cite> files in there, add metadata
to them in <a class="reference external" href="http://www.yaml.org/">YAML</a> format and run the generator-script.</p>
<p>Because it's static, you don't need any dynamic webserver or interpreter, it's just plain HTML files
that you can serve practically everywhere. You can even track them using a source control system.
And last but not least – you'll never have to update your Wordpress installation again, yay!</p>
<p>rstblog supports everything a blog needs: detail pages, archive pages, tags,
atom feeds and comments (using <a class="reference external" href="http://disqus.com/">Disqus</a>). You can create
custom stylesheets and templates.</p>
<p>You can also embed syntax highlighted code using <a class="reference external" href="http://pygments.org/">pygments</a>:</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">bar</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;I don</span><span class="se">\&#39;</span><span class="s">t like spam!&#39;</span>
</pre></div>
<p>And <a class="reference external" href="http://www.latex-project.org/">LaTeX</a> formulas:</p>
<blockquote class="math"><img src="/static/_math/d53927719c238cece74d6de3f2bc80ff512faf78.png" alt="f(x) = a_0 + \sum_{n=1}^{\infty}\left(a_n \cos \frac{n \pi x}{L} + b_n \sin \frac{n \pi x}{L}\right)"></blockquote><p>There's even more to like. If you want to know more, take a look at the
<a class="reference external" href="https://github.com/mitsuhiko/rstblog">repository and the sourcecode</a>. That's
also one of the downsides – there's no official documentation and the project
seems pretty inactive, pull requests aren't being merged.</p>
<p>To get started, here are some related blogposts:</p>
<ul class="simple">
<li><a class="reference external" href="http://codesymphony.net/2011/09/10/setting-up-rstblog/">http://codesymphony.net/2011/09/10/setting-up-rstblog/</a></li>
<li><a class="reference external" href="http://nblock.org/2011/08/31/1st-blogpost/">http://nblock.org/2011/08/31/1st-blogpost/</a></li>
<li><a class="reference external" href="http://mattdeboard.net/2011/05/09/more-tips-on-rstblog/">http://mattdeboard.net/2011/05/09/more-tips-on-rstblog/</a></li>
</ul>
</div>
<div class="section" id="publishing-content">
<h2>Publishing Content</h2>
<p>To easily publish content, I use <a class="reference external" href="http://fabfile.org/">Fabric</a> and <a class="reference external" href="http://rsync.samba.org/">rsync</a>. Some easy fab tasks simplify the workflow:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">fabric.api</span> <span class="kn">import</span> <span class="n">local</span><span class="p">,</span> <span class="n">env</span>
<span class="kn">from</span> <span class="nn">fabric.contrib.project</span> <span class="kn">import</span> <span class="n">rsync_project</span>

<span class="n">env</span><span class="o">.</span><span class="n">hosts</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ich-wars-nicht.ch&#39;</span><span class="p">]</span>
<span class="n">env</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#39;/var/www/dbrgn/blog/&#39;</span>

<span class="k">def</span> <span class="nf">push</span><span class="p">():</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;git push&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">serve</span><span class="p">():</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;run-rstblog serve&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">():</span>
    <span class="c"># Build HTML</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;rm -rf _build/ &amp;&amp; run-rstblog build&#39;</span><span class="p">)</span>

    <span class="c"># Generate sitemaps</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;python gensitemap.py &gt; _build/sitemap.xml&#39;</span><span class="p">)</span>

    <span class="c"># Minify CSS</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;cssmin &lt; _build/static/style.css &gt; _build/static/style.min.css&#39;</span><span class="p">)</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;mv _build/static/style.min.css _build/static/style.css&#39;</span><span class="p">)</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;cssmin &lt; _build/static/_pygments.css &gt; _build/static/_pygments.min.css&#39;</span><span class="p">)</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;mv _build/static/_pygments.min.css _build/static/_pygments.css&#39;</span><span class="p">)</span>

    <span class="c"># Add timestamp to css files</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;find _build -type f -exec sed -i &quot;s/\(link.*\)&#39;</span> <span class="o">+</span> \
          <span class="s">&#39;style.css/</span><span class="se">\\</span><span class="s">1style.css?</span><span class="si">%s</span><span class="s">/g&quot; {} \;&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span>
    <span class="n">local</span><span class="p">(</span><span class="s">&#39;find _build -type f -exec sed -i &quot;s/\(link.*\)&#39;</span> <span class="o">+</span> \
          <span class="s">&#39;_pygments.css/</span><span class="se">\\</span><span class="s">1_pygments.css?</span><span class="si">%s</span><span class="s">/g&quot; {} \;&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span>

<span class="k">def</span> <span class="nf">sync</span><span class="p">():</span>
    <span class="n">rsync_project</span><span class="p">(</span><span class="n">remote_dir</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
                  <span class="n">local_dir</span><span class="o">=</span><span class="s">&#39;_build/&#39;</span><span class="p">,</span>
                  <span class="n">delete</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;*.py&#39;</span><span class="p">,</span> <span class="s">&#39;*.pyc&#39;</span><span class="p">,</span> <span class="s">&#39;requirements.txt&#39;</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">deploy</span><span class="p">():</span>
    <span class="n">build</span><span class="p">()</span>
    <span class="n">sync</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">publish</span><span class="p">():</span>
    <span class="n">deploy</span><span class="p">()</span>
    <span class="n">push</span><span class="p">()</span>
</pre></div>
<p>You can see the entire fabfile <a class="reference external" href="https://github.com/dbrgn/blog/blob/master/fabfile.py">on Github</a>. The sitemaps are
generated by <a class="reference external" href="https://github.com/dbrgn/blog/blob/master/gensitemap.py">gensitemap.py</a>.</p>
<p>By issueing a simple <tt class="docutils literal">fab publish</tt> in the root directory, the following steps
are taken:</p>
<ul class="simple">
<li>The <cite>_build</cite> directory is (re)built</li>
<li>Sitemaps are generated for each <cite>.html</cite> file</li>
<li>CSS files are minified in-place</li>
<li>A timestamp is appended to all CSS file names to make browsers reload cached
content</li>
<li>The <cite>_build</cite> directory is deployed to the server</li>
<li>The git repository is pushed to Github</li>
</ul>
</div>
<div class="section" id="this-blog">
<h2>This Blog</h2>
<p>Besides the blog-related technical details, this blog will from now on focus
mostly on technical content, usually written in English, mostly about Python /
Django / Linux / Programming related things.</p>
<p>The blog repository is <a class="reference external" href="https://github.com/dbrgn/blog">published on Github</a>. Content is under a CC by-sa 3.0 license.</p>
</div>


  
      <a href="https://flattr.com/submit/auto?user_id=danilo&url=http://blog.dbrgn.ch/2012/6/11/rstblog/&title=Goodbye%20Wordpress%2C%20hi%20rstblog%21&description=I%20just%20replaced%20Wordpress%20with%20rstblog.&tags=blog%2C%20python%2C%20rst%2C%20rstblog&category=text">
           <img class="flattrbutton" src="/static/img/flattr-badge-large.png" alt="Flattr this!" /> 
      </a>
  

  
    <div class="tags">
      <p>This entry was tagged
      
        <a href="/tags/blog/">blog</a>, 
        <a href="/tags/python/">python</a>, 
        <a href="/tags/rst/">rst</a> and 
        <a href="/tags/rstblog/">rstblog</a></p>
    </div>
  

  
    
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'dbrgn'; // required: replace example with your forum shortname
    
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

  

            </div>
        </div>

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-1033934-12']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        <script type="text/javascript" src="/static/hyphenator.js"></script>
        <script type="text/javascript">
            Hyphenator.config({
                donthyphenateclassname : 'docutils literal'
            });
            Hyphenator.run();
        </script>

    </body>
</html>
