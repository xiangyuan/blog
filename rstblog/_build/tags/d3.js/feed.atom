<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title type="text">Recent Blog Posts</title>
  <id>http://blog.dbrgn.ch/feed.atom</id>
  <updated>2013-03-08T00:00:00Z</updated>
  <link href="http://blog.dbrgn.ch/" />
  <link href="http://blog.dbrgn.ch/feed.atom" rel="self" />
  <subtitle type="text">Recent blog posts</subtitle>
  <generator>Werkzeug</generator>
  <entry xml:base="http://blog.dbrgn.ch/feed.atom">
    <title type="text">d3.js and X-Requested-With</title>
    <id>http://blog.dbrgn.ch/2013/3/8/d3js-xhr-x-requested-with-header</id>
    <updated>2013-03-08T00:00:00Z</updated>
    <link href="http://blog.dbrgn.ch/2013/3/8/d3js-xhr-x-requested-with-header" />
    <author>
      <name>Danilo Bargen</name>
    </author>
    <content type="html">&lt;p&gt;Most JavaScript frameworks set the &lt;cite&gt;X-Requested-With&lt;/cite&gt; HTTP Header to
&lt;cite&gt;XMLHttpRequest&lt;/cite&gt; when sending non-cross-domain XHR requests. Many web
frameworks like &lt;a class="reference external" href="http://djangoproject.com/"&gt;Django&lt;/a&gt; or &lt;a class="reference external" href="http://flask.pocoo.org/"&gt;Flask&lt;/a&gt; use this to detect AJAX requests.&lt;/p&gt;
&lt;p&gt;Because of issues with &lt;cite&gt;X-Requested-With&lt;/cite&gt; and cross-domain XHR requests, d3.js
&lt;a class="reference external" href="https://github.com/mbostock/d3/pull/592"&gt;does not set that header by default&lt;/a&gt;.
Therefore Django's &lt;cite&gt;request.is_ajax()&lt;/cite&gt; and Flask's &lt;cite&gt;request.is_xhr()&lt;/cite&gt; break.&lt;/p&gt;
&lt;p&gt;In order to make d3 work with those AJAX detection functions, you need to
manually add the header to the request. Instead of&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// Process data&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;you would write&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;X-Requested-With&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;XMLHttpRequest&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// Process data&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; Never use the &lt;cite&gt;X-Requested-With&lt;/cite&gt; header as a security feature. It
provides no security whatsoever and can always be faked.&lt;/p&gt;
</content>
  </entry>
</feed>

