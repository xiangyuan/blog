<!doctype html>
<html lang="en">
    <head>
        <title>Django Forms with Multiple Inheritance</title>

        <!-- meta -->
        <meta name="author" content="Danilo Bargen">
        <meta name="dc.language" content="en-US">
        <meta name="dc.license" content="http://creativecommons.org/licenses/by-sa/3.0/">
        <meta name="description" content="How to validate Django forms in a DRY way using multiple inheritance.">
        <meta name="keywords" content="django">
        
            <meta name="dc.date.created" content="2011-09-12">
            <meta name="dc.date.issued" content="2011-09-12">
        
        <meta name="google-site-verification" content="uJWWR6d5ESb8torD0v97T_07HLMGX7VzQ-smcUTc_IQ" />

        <!-- favicon -->
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <!-- newsfeed -->
        <link href="/feed.atom" rel="alternate" title="Feed" type="application/atom+xml">

        <!-- assets -->
        <link href="https://fonts.googleapis.com/css?family=Linden+Hill:400,400italic" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="/static/style.css?1371592067" type="text/css">
            <link rel="stylesheet" href="/static/_pygments.css?1371592069" type="text/css">
    </head>
    <body>
        <div id="wrapper">
            <div id="blogtitle"><a href="/">blog.dbrgn.ch</a></div>
            <ul id="mainnav">
                <li><a href="/">home</a></li>
                <li><a href="/archive/">archive</a></li>
                <li><a href="/tags/">tags</a></li>
                <li><a href="/blog/">about this blog</a></li>
                <li class="last"><a href="/about/">about me</a></li>
            </ul>

            <div class="clearboth"></div>

            <div id="content" class="hyphenate">
                
  <h1 class="title">Django Forms with Multiple Inheritance</h1>

  
    <div class="date">
      <p>written on Monday, September 12, 2011</p>
    </div>
  

  <p>Sometimes you want to validate only parts of a Django form. A use case
for this would be a user profile. A user may have an extensive user
profile, but sometimes you only want to validate a subset of the form
fields, e.g. the city and the phone number, when providing a profile
edit form. On another page you might want to offer a username change. If
you try to validate one of those forms using POST data for the provided
fields only, the validation will fail because there are other mandatory
fields. In that case, Python's support for multiple inheritance may
suit you.</p>
<div class="section" id="multiple-form-inheritance">
<h2>Multiple form inheritance</h2>
<p>First, define a form for all the form field subsets you might need to
validate.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">FormA</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">u&#39;Username&#39;</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">FormB</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">city</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">u&#39;City&#39;</span><span class="p">))</span>
    <span class="n">phone</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">u&#39;Phone&#39;</span><span class="p">))</span>
</pre></div>
<p>Then create a third form that extends both the first and the second
form. You may also add additional fields.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">FormAB</span><span class="p">(</span><span class="n">FormA</span><span class="p">,</span> <span class="n">FormB</span><span class="p">):</span>
    <span class="n">language</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">u&#39;Language&#39;</span><span class="p">))</span>
</pre></div>
<p>Display the forms:</p>
<div class="highlight"><pre><span class="n">Change</span> <span class="n">Username</span>
<span class="p">{{</span> <span class="n">formA</span><span class="o">.</span><span class="n">as_ul</span> <span class="p">}}</span>

<span class="n">Change</span> <span class="n">City</span><span class="o">/</span><span class="n">Phone</span>
<span class="p">{{</span> <span class="n">formB</span><span class="o">.</span><span class="n">as_ul</span> <span class="p">}}</span>

<span class="n">Entire</span> <span class="n">Userprofile</span>
<span class="p">{{</span> <span class="n">formAB</span><span class="o">.</span><span class="n">as_ul</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="section" id="the-result-looks-correct">
<h2>The result looks correct:</h2>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">FormA</span><span class="p">({</span><span class="s">&#39;username&#39;</span><span class="p">:</span> <span class="s">&#39;danilo&#39;</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">FormB</span><span class="p">({</span><span class="s">&#39;city&#39;</span><span class="p">:</span> <span class="s">&#39;Bern&#39;</span><span class="p">,</span> <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="s">&#39;0791112233&#39;</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">FormAB</span><span class="p">({</span><span class="s">&#39;username&#39;</span><span class="p">:</span> <span class="s">&#39;danilo&#39;</span><span class="p">,</span> <span class="s">&#39;city&#39;</span><span class="p">:</span> <span class="s">&#39;Bern&#39;</span><span class="p">,</span> <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="s">&#39;0791112233&#39;</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">FormAB</span><span class="p">({</span><span class="s">&#39;username&#39;</span><span class="p">:</span> <span class="s">&#39;danilo&#39;</span><span class="p">,</span> <span class="s">&#39;city&#39;</span><span class="p">:</span> <span class="s">&#39;Bern&#39;</span><span class="p">,</span>
<span class="o">...</span>             <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="s">&#39;0791112233&#39;</span><span class="p">,</span> <span class="s">&#39;language&#39;</span><span class="p">:</span> <span class="s">&#39;de&#39;</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<span class="bp">True</span>
</pre></div>
<img alt="Django form" class="align-center" src="http://blog.ich-wars-nicht.ch/wp-content/uploads/2011/09/2011-09-12-185255_291x225_scrot.png" />
</div>


  
      <a href="https://flattr.com/submit/auto?user_id=danilo&url=http://blog.dbrgn.ch/2011/9/12/django-forms-with-multiple-inheritance/&title=Django%20Forms%20with%20Multiple%20Inheritance&description=How%20to%20validate%20Django%20forms%20in%20a%20DRY%20way%20using%20multiple%20inheritance.&tags=django&category=text">
           <img class="flattrbutton" src="/static/img/flattr-badge-large.png" alt="Flattr this!" /> 
      </a>
  

  
    <div class="tags">
      <p>This entry was tagged
      
        <a href="/tags/django/">django</a></p>
    </div>
  

  
    
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'dbrgn'; // required: replace example with your forum shortname
    
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

  

            </div>
        </div>

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-1033934-12']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        <script type="text/javascript" src="/static/hyphenator.js"></script>
        <script type="text/javascript">
            Hyphenator.config({
                donthyphenateclassname : 'docutils literal'
            });
            Hyphenator.run();
        </script>

    </body>
</html>
